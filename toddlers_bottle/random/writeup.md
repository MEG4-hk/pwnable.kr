# random

***Daddy, teach me how to use random value in programming!***

## Recon

In this challenge we recieve a connection to the server via ssh

	ssh random@pwnable.kr -p2222 (pw:guest)

### Source files an binaries

In the server, we look at the files given to us.

	$ ls
	flag, random, random.c

We have a C source and a binary.

#### Understanding the source

This challenge is about randomization and random values. Accordingly, the first thing</br>
being done in the source is getting a random value integer, and saves it at a local</br>
variable named `random`.

	unsigned int random;
	random = rand();	// random value!

Later, the program gets a numeric value as input from the user and saves it as a local</br>
variable named `key`.

	unsigned int key=0;
	scanf("%d", &key);

At this point, the program compares the xor operation on `key` and `random`, with a</br>
hard-coded value `0xDEADBEEF`. If matches, we get a flag!

	 if( (key ^ random) == 0xdeadbeef ){
		printf("Good!\n");
		system("/bin/cat flag");
		return 0;
	}

If the comparison did not match, the program prints us a message suggesting that we</br>
brute-force it by trying 2^32 (or 4294967296) cases. Not ideal for us.

### Identifying a target

Looking at the comparison, we can understand that if we input a numeric value that,</br>
when xor'ed with a random value that should change with each execution, returns an</br>
output of `0XDEADBEEF`, we solve the challenge.

But how can we know the value every execution if its random? Here's how we'll do it:</br>
It's not random!

To distinguish between random values in different programs, and from every execution</br>
of the program, computers uses a seed to generate the random values. Since the seed</br>
is not set in the source code, the same "random" value will be generated, every</br>
execution of the program. Okay, so the value we need to find doesn't change each</br>
execution. But it's not only that: Using the same line of code in another program</br>
will give us the same value!

We will set our target to be finding the value that is generated using the `rand()`</br>
function, then using it to find the value that when xor'ed with the "random" value,</br>
gives us `0xDEADBEEF`.

### Identifying interactions

We have one interaction with the program, by inputting a numeric value into the</br>
`key` variable.

## Solving the challenge

Step one is to find the value generated by `rand()`. We can simply do it by writing</br>
a small program to do it for us. Since we do not give it any seed, the same value</br>
will be generated, always.

	#include <stdio.h>
	int main(void) {
		printf("Random value: %u\n", rand());
		return 0;
	}

Let's compile and run the program, and then see the results.

	$ gcc scripts/random_value.c -o scripts/random_value
	$ ./scripts/random_value
	Random value: 1804289383

Let's run it again.

	$ ./scripts/random_value
	Random value: 1804289383

Great! we found the value that will be generated by `rand()` always.

Step 2 is xoring the result we want, `0xDEADBEEF`, with what we have `1804289383`.</br>
This will reverse the xor operation done by the program.

	key ^ random = 0xDEADBEEF -> 0xDEADBEEF ^ random = key

We have `random` and we have the hard-coded value. Let's find `key`

	0xdeadbeef = 3735928559
	3735928559 ^ 1804289383 = 3039230856

By entering the value `3039230856` as `key`, we get the flag.