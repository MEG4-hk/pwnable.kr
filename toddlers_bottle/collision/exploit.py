#!/usr/bin/python3


from pwn import *


def calculate_payload():
	hashcode = int.from_bytes(b'\xec\x09\xdd\x21', 'little')

	# calculate the value of the first 16 bytes
	first_bytes_value = int.from_bytes(b'\x01'*4, 'little') * 4

	# calculate the value of the last 4 bytes and construct a payload
	last_bytes = (hashcode-first_bytes_value).to_bytes(10, 'little')
	payload = b'\x01'*16 + last_bytes[:4]

	return payload


s = ssh(host='pwnable.kr', port=2222, user='col', password='guest')
a = s.process(['./col', calculate_payload()])
print('[+] flag = {}'.format(a.recv(1024).decode()))
